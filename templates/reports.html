<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account</title>
    <link href="{{ url_for('static', filename='css/halfmoon.css') }}" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/stylesheet.css') }}">
    <script src="https://cdn.anychart.com/releases/8.0.0/js/anychart-base.min.js"></script>
</head>

<body class="with-custom-webkit-scrollbars with-custom-css-scrollbars" data-dm-shortcut-enabled="true" data-set-preferred-mode-onload="true">
    <div class="page-wrapper with-navbar">
        <div class="sticky-alerts"></div>
        <nav class="navbar">
            <a href="#" class="navbar-brand rounded">
                <img src="{{url_for('static', filename='assets/logo.png')}}" alt="StuBankLogo"> StuBank
            </a>
            <ul class="navbar-nav d-none d-md-flex">
                <li class="nav-item active">
                    <a href="#" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">Move Money</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">Account Settings </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">Manage Cards</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">Manage Overdraft</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">Manage Pools</a>
                </li>
            </ul>
            <form class="form-inline d-none d-md-flex ml-auto" action="..." method="...">
                <input class="btn btn-danger" type="submit" value="Logout" formaction="{{ url_for('index_page') }}">
                <input class="btn btn-danger" type="submit" value="Back" formaction="/accounts.html">
            </form>
            <div class="navbar-content d-md-none ml-auto">
                <div class="dropdown with-arrow">
                    <button class="btn" data-toggle="dropdown" type="button" id="navbar-dropdown-toggle-btn-1">
                        Menu
                        <i class="fa fa-angle-down" aria-hidden="true"></i>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right w-200" aria-labelledby="navbar-dropdown-toggle-btn-1">
                        <a href="#" class="dropdown-item">Home</a>
                        <a href="#" class="dropdown-item">Move Money</a>
                        <a href="#" class="dropdown-item">Account Settings</a>
                        <a href="#" class="dropdown-item">Manage Cards</a>
                        <a href="#" class="dropdown-item">Manage Overdraft</a>
                        <a href="#" class="dropdown-item">Manage Pools</a>

                        <div class="dropdown-divider"></div>
                        <div class="dropdown-content">
                            <form action="..." method="...">
                                <input class="btn btn-danger btn-block mb-5" type="submit" value="Logout" formaction="{{ url_for('index_page') }}">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="content-wrapper">
            <button id="daysButton" onclick="last7Days()">Show expenditure report for last 7 days</button>
            <button id="weeksButton" onclick="weeklyReport()">Show this week's report and compare spending to previous weeks</button>
            <div hidden id="container7days" style="width: 100%; height: 100%"></div>
            <div hidden id="containerWeekly" style="width: 100%; height: 100%"></div>
            <script type="text/javascript">
                function last7Days() {
                    document.getElementById("containerWeekly").hidden = true;
                    document.getElementById("container7days").hidden = false; //hides irrelevant container
                    let dates = [];
                    let currentDate = new Date(); //gets current date
                    dates.push(currentDate); //adds current date to array
                    for(var i = 0; i < 6; i++){
                        currentDate.setDate(currentDate.getDate() - 1);
                        dates.push(new Date(currentDate)); //gets date of previous 7 days and adds to array
                    }
                    dates[0] = new Date(); //resets data stored in dates[0] so it holds current date again

                    // set the data
                    var data = {
                        header: ["Day", "Expenditure"],
                        rows: [
                            ["" + dates[0].getDate() + "/" + (dates[0].getMonth() + 1), 125],
                            ["" + dates[1].getDate() + "/" + (dates[1].getMonth() + 1), 12],
                            ["" + dates[2].getDate() + "/" + (dates[2].getMonth() + 1), 87],
                            ["" + dates[3].getDate() + "/" + (dates[3].getMonth() + 1), 69],
                            ["" + dates[4].getDate() + "/" + (dates[4].getMonth() + 1), 19],
                            ["" + dates[5].getDate() + "/" + (dates[5].getMonth() + 1), 1.5],
                            ["" + dates[6].getDate() + "/" + (dates[6].getMonth() + 1), 82],
                        ]
                    };

                    // create the chart
                    var chart = anychart.column();

                    // add the data
                    chart.data(data);

                    // set the chart title
                    chart.title("Expenditure report for the last 7 days");

                    //sets chart colour theme based on if site is in dark/light mode
                    if (halfmoon.readCookie("halfmoon_preferredMode")) {
                        if (halfmoon.readCookie("halfmoon_preferredMode") == "light-mode") {
                            anychart.theme(anychart.themes.lightTurquoise);
                        }
                        else if (halfmoon.readCookie("halfmoon_preferredMode") == "dark-mode") {
                            anychart.theme(anychart.themes.darkTurquoise);
                        }
                    }

                    var div = document.getElementById('container7days');
                    while(div.firstChild){
                        div.removeChild(div.firstChild);
                    } //clears div so multiple repeat graphs don't appear

                    // draw
                    chart.container("container7days");
                    chart.draw();

                    document.getElementById("daysButton").disabled = true; //fixes bug where repeat graphs can be drawn
                    document.getElementById("weeksButton").disabled = false;
                }
                function weeklyReport(){
                    document.getElementById("containerWeekly").hidden = false;
                    document.getElementById("container7days").hidden = true; //hides irrelevant container

                    document.getElementById("daysButton").disabled = false;
                    document.getElementById("weeksButton").disabled = true; //fixes bug where repeat graphs can be drawn
                }
            </script>
            <nav class="navbar navbar-static-bottom">
                <div class="container-fluid">
                    <button class="btn btn-primary" type="button" onclick="toggleDark()">Toggle Darkmode!</button>

                    <!-- JavaScript -->
                    <script type="text/javascript">
                        // Dark mode toggle
                        function toggleDark() {
                            halfmoon.toggleDarkMode();
                        }
                    </script>
                    <ul class="navbar-nav ml-auto">
                        <!-- ml-auto = margin-left: auto -->
                        <li class="nav-item">
                            <a href="#" class="nav-link">Contact</a>
                        </li>
                    </ul>
                    <!-- Navbar text -->
                    <span class="navbar-text">
                        <p>
                            &copy; <strong>StuBank </strong> a project by Team35
                        </p>
                    </span>
                </div>
            </nav>
        </div>
        <!-- Halfmoon JS -->
        <script src="https://cdn.jsdelivr.net/npm/halfmoon@1.1.1/js/halfmoon.min.js"></script>
    </div>
</body>


</html>